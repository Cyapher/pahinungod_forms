{% extends 'base_partner.html' %}
{% load static %}

{% block content %}

<style>
    table {
        table-layout:auto;
        max-width: 90%;
    }

</style>

<h1 style="margin: auto; text-align: center;"> Partners List  </h1>

<br>

<div class="d-flex justify-content-center">

    <table rules="all" class="table table-bordered table-striped d-flex-col justify-content-center border">
        {% if partners %}
        <thead>
            <th>Stakeholder Name</th>
            <th>Title of Partnership/Linkage</th>
            <th>Stakeholder Category</th>
            <th>Type of Partnership</th>
            <th>Stakeholder Files</th>
            <th></th>
        </thead>
        {% endif %}

        <tbody>
            {% for partner in partners %}
    
            <tr>
                <td>
                    <p> {{ partner.partner_name }} </p>
                </td>
                <td>
                    <p> {{ partner.partnership_extension }} </p>
                </td>
                <td>
                    <p> {{ partner.stakeholder_category }} - 
                        {% if partner.second_category == 'Others' %} 
                            {{ partner.other_choice }}
                        {% else %}
                            {{ partner.second_category }}
                        {% endif %}
                    </p>
                </td>
                <td>
                    <!-- TYPES -->
                    {% for type in partner.type_of_partnership.all %}
    
                        <li>({{type.type_code}}) {{type.type_of_partnership}}</li>
                        
                        {% empty %}
                        <p> No Type Placed </p>
    
                    {% endfor %}
                </td>
                <td>
                    <!-- FILES -->
                    <ul>
                        {% for partner_item, file_list in partners_list.items %}
                            {% if partner_item == partner %}
                                {% for file in file_list %}
                                    <!-- <p>{{ file.file_field }}</p>
                                    <p>{{ file.file_name }}</p> -->
                                    {% with "partner_requirements/"|add:file.file_name as file_path %}
                                        <li><a href="{% static file_path %}" target="_blank">{{ file.file_name }}</a></li>
                                    {% endwith %}
                                {% endfor %}
                            {% endif %}
                        {% endfor %}
                    </ul>
                </td>
                <!-- ACTIONS -->
                <td>
                    <div class="d-flex justify-content-center">
                        <form class="px-2" action="{% url 'upd_partner' partner.id %}">
                            {% csrf_token %}
                            <input type="submit" value="Update">
                        </form>
                        <form class="px-2" action="{% url 'del_partner' partner.id %}" method="POST">
                            {% csrf_token %}
                            <input type="submit" value="Delete">
                        </form>
                    </div>                    
                </td>
            </tr>     
    
            {% empty %}
            <tr>
                <td colspan="6" align="center">
                    <h2>No Partners Available</h2>
                    <p>Nu bayun...</p>
                </td>
            </tr>
                
    
            {% endfor %}
    
        </tbody>
        
    </table>
</div>


<script>
    document.getElementById('partners').className += ' active bg-secondary'

</script>

{% endblock %}